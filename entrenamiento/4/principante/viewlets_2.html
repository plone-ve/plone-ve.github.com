

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Un viewlet para el comportamiento voteable &mdash; Maestría en Plone, un entrenamiento para principiantes - 1.2.5a</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
        <link rel="author" title="Sobre este documento"
              href="about.html"/>
    <link rel="top" title="documentación de Maestría en Plone - 1.2.5a" href="index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> Maestría en Plone</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">Sobre &#8220;Maestría en Plone&#8221;</a><ul>
<li class="toctree-l2"><a class="reference internal" href="about.html#upcoming-trainings">Próximos entrenamientos</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#previous-trainings">Entrenamientos previos</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#trainers">Entrenadores</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#using-the-documentation-for-a-training">Usando la documentación para un entrenamiento</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#contributing">Contribuyendo</a></li>
<li class="toctree-l2"><a class="reference internal" href="about.html#license">Licencia</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Introducción</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#who-are-you">¿Quien eres tu?</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#what-will-we-do">¿Qué haremos?</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#what-will-we-not-do">¿Qué no haremos?</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#what-to-expect">¿Qué esperar?</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#documentation">Documentación</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#further-reading">Lecturas recomendadas</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">2. Instalación y configuración</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installing-plone">Instalando Plone</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#hosting-plone">Alojando Plone</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#production-deployment">Despliegue en ambientes de producción</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plone_training_config/instructions.html">3. Instalando Plone para el entrenamiento</a><ul>
<li class="toctree-l2"><a class="reference internal" href="plone_training_config/instructions.html#installing-plone-without-vagrant">Instalando Plone sin Vagrant</a></li>
<li class="toctree-l2"><a class="reference internal" href="plone_training_config/instructions.html#install-virtualbox">Instalar VirtualBox</a></li>
<li class="toctree-l2"><a class="reference internal" href="plone_training_config/instructions.html#install-and-configure-vagrant">Instalar y configurar Vagrant</a></li>
<li class="toctree-l2"><a class="reference internal" href="plone_training_config/instructions.html#what-vagrant-does">¿Qué hace Vagrant?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="anatomy.html">4. La Anatomía de Plone</a><ul>
<li class="toctree-l2"><a class="reference internal" href="anatomy.html#zope2">Zope2</a></li>
<li class="toctree-l2"><a class="reference internal" href="anatomy.html#content-management-framework">Content Management Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="anatomy.html#zope-toolkit-zope3">Zope Toolkit / Zope3</a></li>
<li class="toctree-l2"><a class="reference internal" href="anatomy.html#zope-component-architecture-zca">Zope Component Architecture (ZCA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="anatomy.html#pyramid">Pyramid</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="case.html">5. El caso de estudio</a><ul>
<li class="toctree-l2"><a class="reference internal" href="case.html#background">Detalle</a></li>
<li class="toctree-l2"><a class="reference internal" href="case.html#requirements">Requerimientos</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="features.html">6. Las características de Plone</a><ul>
<li class="toctree-l2"><a class="reference internal" href="features.html#starting-and-stopping-plone">Iniciando y Deteniendo Plone</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#users">Usuarios</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#configure-a-mailserver">Configurar un servidor de correo</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#walkthrough-of-the-ui">Tutorial de la interfaz de usuario</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#content-types">Tipos de Contenidos</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#folders">Carpetas</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#collections">Colecciones</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#content-rules">Reglas de Contenido</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#history">Histórico</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#manage-members-and-groups">Administrar usuarios y grupos</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#workflows">Flujos de trabajos</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#working-copy">Copia de trabajo</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#placeful-workflows">Flujos de trabajo Placeful</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuring_customizing.html">7. Configurando y personalizando Plone a través de la Web</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configuring_customizing.html#the-control-panel">El panel de control</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuring_customizing.html#portlets">Portlets</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuring_customizing.html#viewlets">Viewlets</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuring_customizing.html#zmi">ZMI</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuring_customizing.html#summary">Resumen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="extending.html">8. Extendiendo Plone</a><ul>
<li class="toctree-l2"><a class="reference internal" href="extending.html#extension-technologies">Tecnologías de extensión</a></li>
<li class="toctree-l2"><a class="reference internal" href="extending.html#what-are-components-what-is-zcml">¿Cuáles son los componentes?, ¿Que es el ZCML?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="addons.html">9. Extiende Plone con paquetes Complementos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="addons.html#how-to-find-add-ons">¿Como buscar complementos?</a></li>
<li class="toctree-l2"><a class="reference internal" href="addons.html#some-notable-add-ons">Algunos complementos notables</a></li>
<li class="toctree-l2"><a class="reference internal" href="addons.html#installing-add-ons">Instalando complementos</a></li>
<li class="toctree-l2"><a class="reference internal" href="addons.html#ploneformgen">PloneFormGen</a></li>
<li class="toctree-l2"><a class="reference internal" href="addons.html#add-photogallery-with-collective-plonetruegallery">Agregar Galerías de fotos con collective.plonetruegallery</a></li>
<li class="toctree-l2"><a class="reference internal" href="addons.html#internationalization">Internacionalización</a></li>
<li class="toctree-l2"><a class="reference internal" href="addons.html#summary">Resumen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="theming.html">10. Temas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="theming.html#diazo-example">ejemplo Diazo</a></li>
<li class="toctree-l2"><a class="reference internal" href="theming.html#templating-example">ejemplo de Plantila</a></li>
<li class="toctree-l2"><a class="reference internal" href="theming.html#choosing-the-right-tool">Seleccionando la herramienta adecuada</a></li>
<li class="toctree-l2"><a class="reference internal" href="theming.html#want-to-really-learn-theming">¿Quieres aprender realmente tematización?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dexterity.html">11. Dexterity - Parte I: A través de la Web</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dexterity.html#what-is-a-content-type">¿Qué es un tipo de contenido?</a></li>
<li class="toctree-l2"><a class="reference internal" href="dexterity.html#the-makings-of-a-plone-content-type">Los elementos de un tipo de contenido Plone</a></li>
<li class="toctree-l2"><a class="reference internal" href="dexterity.html#dexterity-and-archetypes-a-comparison">Dexterity y Archetypes - Una comparación</a></li>
<li class="toctree-l2"><a class="reference internal" href="dexterity.html#installation">Instalación</a></li>
<li class="toctree-l2"><a class="reference internal" href="dexterity.html#modifying-existing-types">Modificando tipos existentes</a></li>
<li class="toctree-l2"><a class="reference internal" href="dexterity.html#creating-content-types-ttw">Creando tipos de contenidos a través de la Web</a></li>
<li class="toctree-l2"><a class="reference internal" href="dexterity.html#moving-content-types-into-code">Moviendo el tipo de contenido dentro del código fuente</a></li>
<li class="toctree-l2"><a class="reference internal" href="dexterity.html#exercises">Ejercicios</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="buildout_1.html">12. Buildout - Parte I</a><ul>
<li class="toctree-l2"><a class="reference internal" href="buildout_1.html#syntax">Sintaxis</a></li>
<li class="toctree-l2"><a class="reference internal" href="buildout_1.html#recipes">Recetas</a></li>
<li class="toctree-l2"><a class="reference internal" href="buildout_1.html#references">Referencias</a></li>
<li class="toctree-l2"><a class="reference internal" href="buildout_1.html#a-real-life-example">Un ejemplo de la vida real</a></li>
<li class="toctree-l2"><a class="reference internal" href="buildout_1.html#hello-mr-developer">¡Hola mr.developer!</a></li>
<li class="toctree-l2"><a class="reference internal" href="buildout_1.html#extensible">Extensible</a></li>
<li class="toctree-l2"><a class="reference internal" href="buildout_1.html#be-mcguyver">Sea un McGuyver</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="eggs1.html">13. Creando complementos para personalizar Plone</a><ul>
<li class="toctree-l2"><a class="reference internal" href="eggs1.html#using-zopeskel-to-create-an-egg">Usando zopeskel para crear un paquete egg</a></li>
<li class="toctree-l2"><a class="reference internal" href="eggs1.html#inspecting-the-package">Inspeccione el paquete</a></li>
<li class="toctree-l2"><a class="reference internal" href="eggs1.html#including-the-egg-in-plone">Incluyendo el paquete egg en Plone</a></li>
<li class="toctree-l2"><a class="reference internal" href="eggs1.html#return-to-dexterity-moving-content-types-into-code">Volver Dexterity: para mover tipos de contenidos a código fuente</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="views_1.html">14. Views - Parte I</a><ul>
<li class="toctree-l2"><a class="reference internal" href="views_1.html#a-simple-browser-view">Una simple browser view</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="zpt.html">15. Zope Page Templates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="zpt.html#tal-and-tales">TAL y TALES</a></li>
<li class="toctree-l2"><a class="reference internal" href="zpt.html#metal-and-macros">METAL y macros</a></li>
<li class="toctree-l2"><a class="reference internal" href="zpt.html#accessing-plone-from-the-template">Accediendo a Plone desde la plantilla</a></li>
<li class="toctree-l2"><a class="reference internal" href="zpt.html#what-we-missed">Lo que echamos de menos</a></li>
<li class="toctree-l2"><a class="reference internal" href="zpt.html#chameleon">Chameleon</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="zpt_2.html">16. Personalizar plantillas existentes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="zpt_2.html#newsitem-pt">El archivo newsitem.pt</a></li>
<li class="toctree-l2"><a class="reference internal" href="zpt_2.html#summary-view-pt">El archivo summary_view.pt</a></li>
<li class="toctree-l2"><a class="reference internal" href="zpt_2.html#finding-the-right-template">Buscando la correcta plantilla</a></li>
<li class="toctree-l2"><a class="reference internal" href="zpt_2.html#skin-templates">Plantillas skins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="views_2.html">17. Views - Parte II: Una vista por defecto para la &#8220;charla&#8221;</a><ul>
<li class="toctree-l2"><a class="reference internal" href="views_2.html#view-classes">Vista de clases</a></li>
<li class="toctree-l2"><a class="reference internal" href="views_2.html#the-default-view">La vista por defecto</a></li>
<li class="toctree-l2"><a class="reference internal" href="views_2.html#exercise">Ejercicio</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="views_3.html">18. Views - Parte III: Una lista de Charlas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="views_3.html#using-portal-catalog">Usando portal_catalog</a></li>
<li class="toctree-l2"><a class="reference internal" href="views_3.html#brains-and-objects">Cerebros y objetos</a></li>
<li class="toctree-l2"><a class="reference internal" href="views_3.html#querying-the-catalog">Consultando el catálogo</a></li>
<li class="toctree-l2"><a class="reference internal" href="views_3.html#exercises">Ejercicios</a></li>
<li class="toctree-l2"><a class="reference internal" href="views_3.html#the-template-for-the-listing">La plantilla para la lista</a></li>
<li class="toctree-l2"><a class="reference internal" href="views_3.html#setting-a-custom-view-as-default-view-on-an-object">Configuración de una vista personalizada como vista por defecto en un objeto</a></li>
<li class="toctree-l2"><a class="reference internal" href="views_3.html#adding-some-javascript-collective-js-datatables">Agregando un poco de Javascript (collective.js.datatables)</a></li>
<li class="toctree-l2"><a class="reference internal" href="views_3.html#summary">Resumen</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="CHANGES.html">Registro de cambios</a><ul>
<li class="toctree-l2"><a class="reference internal" href="CHANGES.html#unreleased">1.2.5 (unreleased)</a></li>
<li class="toctree-l2"><a class="reference internal" href="CHANGES.html#id1">1.2.4 (2014-10-03)</a></li>
<li class="toctree-l2"><a class="reference internal" href="CHANGES.html#id2">1.2.3 (2014-07-11)</a></li>
<li class="toctree-l2"><a class="reference internal" href="CHANGES.html#id3">1.2.2 (2014-06-01)</a></li>
<li class="toctree-l2"><a class="reference internal" href="CHANGES.html#id4">1.2.1 (2014-05-30)</a></li>
<li class="toctree-l2"><a class="reference internal" href="CHANGES.html#id5">1.2 (2014-05-23)</a></li>
<li class="toctree-l2"><a class="reference internal" href="CHANGES.html#october-2013">1.1 (October 2013)</a></li>
<li class="toctree-l2"><a class="reference internal" href="CHANGES.html#october-2012">1.0 (October, 2012)</a></li>
<li class="toctree-l2"><a class="reference internal" href="CHANGES.html#october-2011">0.2 October 2011</a></li>
<li class="toctree-l2"><a class="reference internal" href="CHANGES.html#october-2009">0.1 (October 2009)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Mapa de ruta</a><ul>
<li class="toctree-l2"><a class="reference internal" href="roadmap.html#id1">1.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="roadmap.html#todo">Todo</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Maestría en Plone</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Un viewlet para el comportamiento voteable</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="a-viewlet-for-the-voteable-behavior">
<h1>Un viewlet para el comportamiento voteable<a class="headerlink" href="#a-viewlet-for-the-voteable-behavior" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="section" id="voting-viewlet">
<h2>Viewlet Voting<a class="headerlink" href="#voting-viewlet" title="Enlazar permanentemente con este título">¶</a></h2>
<ul class="simple">
<li><p class="first">Viewlet para IVoteable</p>
</li>
<li><p class="first">la plantilla del viewlet</p>
</li>
<li><p class="first">agregar jQuery incluyen declaraciones</p>
</li>
<li><p class="first">guardar el voto en el objeto usando anotaciones</p>
</li>
</ul>
<p>Earlier we added the logic that saves votes on the objects. We now create the user interface for it.</p>
<p>Since we want to use the UI on more than one page (not only the talk-view but also the talk-listing) we need to put it somewhere.</p>
<ul class="simple">
<li>To handle the user-input we don&#8217;t use a form but links and ajax.</li>
<li>The voting itself is a fact handled by another view</li>
</ul>
<p>Registramos el viewlet en el archivo <code class="file docutils literal"><span class="pre">browser/configure.zcml</span></code>.</p>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre> <span class="nt">&lt;configure</span> <span class="na">xmlns=</span><span class="s">&quot;http://namespaces.zope.org/zope&quot;</span>
     <span class="na">xmlns:browser=</span><span class="s">&quot;http://namespaces.zope.org/browser&quot;</span><span class="nt">&gt;</span>

     ...

<span class="hll">   <span class="nt">&lt;browser:viewlet</span>
</span><span class="hll">     <span class="na">name=</span><span class="s">&quot;voting&quot;</span>
</span><span class="hll">     <span class="na">for=</span><span class="s">&quot;starzel.votable_behavior.interfaces.IVoting&quot;</span>
</span><span class="hll">     <span class="na">manager=</span><span class="s">&quot;plone.app.layout.viewlets.interfaces.IBelowContentTitle&quot;</span>
</span><span class="hll">     <span class="na">layer=</span><span class="s">&quot;..interfaces.IVotableLayer&quot;</span>
</span><span class="hll">     <span class="na">class=</span><span class="s">&quot;.viewlets.Vote&quot;</span>
</span><span class="hll">     <span class="na">template=</span><span class="s">&quot;templates/voting_viewlet.pt&quot;</span>
</span><span class="hll">     <span class="na">permission=</span><span class="s">&quot;zope2.View&quot;</span>
</span><span class="hll">     <span class="nt">/&gt;</span>
</span>
     ....

 <span class="nt">&lt;/configure&gt;</span>
</pre></div>
</td></tr></table></div>
<p>Nosotros extendemos en el archivo <code class="file docutils literal"><span class="pre">browser/viewlets.py</span></code></p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">plone.app.layout.viewlets</span> <span class="kn">import</span> <span class="n">common</span> <span class="k">as</span> <span class="n">base</span>


<span class="k">class</span> <span class="nc">Vote</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">ViewletBase</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</td></tr></table></div>
<p>This will add a viewlet to a slot below the title and expect a template <code class="file docutils literal"><span class="pre">voting_viewlet.pt</span></code> in a folder <code class="file docutils literal"><span class="pre">browser/templates</span></code>.</p>
<p>Let&#8217;s create the file <code class="file docutils literal"><span class="pre">browser/templates/voting_viewlet.pt</span></code> without any logic</p>
<div class="highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre> <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;voting&quot;</span><span class="nt">&gt;</span>
     Wanna vote? Write code!
 <span class="nt">&lt;/div&gt;</span>

 <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
   <span class="nx">jq</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
     <span class="c1">// please add some jQuery-magic</span>
   <span class="p">});</span>
 <span class="nt">&lt;/script&gt;</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li><p class="first">reiniciar Plone</p>
</li>
<li><p class="first">mostrar el viewlet</p>
</li>
</ul>
</div>
<div class="section" id="writing-the-viewlet-code">
<h2>Escribiendo el código fuente del Viewlet<a class="headerlink" href="#writing-the-viewlet-code" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Update the viewlet to contain the necessary logic in <code class="file docutils literal"><span class="pre">browser/viewlets</span></code></p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">plone.app.layout.viewlets</span> <span class="kn">import</span> <span class="n">common</span> <span class="k">as</span> <span class="n">base</span>
<span class="kn">from</span> <span class="nn">Products.CMFCore.permissions</span> <span class="kn">import</span> <span class="n">ViewManagementScreens</span>
<span class="kn">from</span> <span class="nn">Products.CMFCore.utils</span> <span class="kn">import</span> <span class="n">getToolByName</span>

<span class="kn">from</span> <span class="nn">starzel.votable_behavior.interfaces</span> <span class="kn">import</span> <span class="n">IVoting</span>


<span class="k">class</span> <span class="nc">Vote</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">ViewletBase</span><span class="p">):</span>

    <span class="n">vote</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">is_manager</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Vote</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vote</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vote</span> <span class="o">=</span> <span class="n">IVoting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_manager</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">membership_tool</span> <span class="o">=</span> <span class="n">getToolByName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span> <span class="s">&#39;portal_membership&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_manager</span> <span class="o">=</span> <span class="n">membership_tool</span><span class="o">.</span><span class="n">checkPermission</span><span class="p">(</span>
                <span class="n">ViewManagementScreens</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">voted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vote</span><span class="o">.</span><span class="n">already_voted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">average</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vote</span><span class="o">.</span><span class="n">average_vote</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">has_votes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vote</span><span class="o">.</span><span class="n">has_votes</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="the-template">
<h2>La plantilla<a class="headerlink" href="#the-template" title="Enlazar permanentemente con este título">¶</a></h2>
<p>And extend the template in <code class="file docutils literal"><span class="pre">browser/templates/voting_viewlet.pt</span></code></p>
<div class="highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;tal:snippet</span> <span class="na">omit-tag=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;voting&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;current_rating&quot;</span> <span class="na">tal:condition=</span><span class="s">&quot;viewlet/has_votes&quot;</span><span class="nt">&gt;</span>
      The average vote for this talk is <span class="nt">&lt;span</span> <span class="na">tal:content=</span><span class="s">&quot;viewlet/average&quot;</span><span class="nt">&gt;</span>200<span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;alreadyvoted&quot;</span> <span class="na">class=</span><span class="s">&quot;voting_option&quot;</span><span class="nt">&gt;</span>
      You already voted this talk. Thank you!
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;notyetvoted&quot;</span> <span class="na">class=</span><span class="s">&quot;voting_option&quot;</span><span class="nt">&gt;</span>
      What do you think of this talk?
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;votes&quot;</span><span class="nt">&gt;&lt;span</span> <span class="na">id=</span><span class="s">&quot;voting_plus&quot;</span><span class="nt">&gt;</span>+1<span class="nt">&lt;/span&gt;</span> <span class="nt">&lt;span</span> <span class="na">id=</span><span class="s">&quot;voting_neutral&quot;</span><span class="nt">&gt;</span>0<span class="nt">&lt;/span&gt;</span> <span class="nt">&lt;span</span> <span class="na">id=</span><span class="s">&quot;voting_negative&quot;</span><span class="nt">&gt;</span>-1<span class="nt">&lt;/span&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;no_ratings&quot;</span> <span class="na">tal:condition=</span><span class="s">&quot;not: viewlet/has_votes&quot;</span><span class="nt">&gt;</span>
      This talk has not been voted yet. Be the first!
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;delete_votings&quot;</span> <span class="na">tal:condition=</span><span class="s">&quot;viewlet/is_manager&quot;</span><span class="nt">&gt;</span>
      Delete all votings
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;delete_votings2&quot;</span> <span class="na">class=</span><span class="s">&quot;areyousure warning&quot;</span>
         <span class="na">tal:condition=</span><span class="s">&quot;viewlet/is_manager&quot;</span>
         <span class="nt">&gt;</span>
      Are you sure?
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;#&quot;</span> <span class="na">class=</span><span class="s">&quot;hiddenStructure&quot;</span> <span class="na">id=</span><span class="s">&quot;context_url&quot;</span>
       <span class="na">tal:attributes=</span><span class="s">&quot;href context/absolute_url&quot;</span><span class="nt">&gt;&lt;/a&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">id=</span><span class="s">&quot;voted&quot;</span> <span class="na">tal:condition=</span><span class="s">&quot;viewlet/voted&quot;</span><span class="nt">&gt;&lt;/span&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
      <span class="nx">starzel_votablebehavior</span><span class="p">.</span><span class="nx">init_voting_viewlet</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.voting&quot;</span><span class="p">));</span>
    <span class="p">});</span>
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/tal:snippet&gt;</span>
</pre></div>
</td></tr></table></div>
<p>We have many small parts, most of which will be hidden by javascript unless needed.
By providing all these status information in HTML, we can use standard translation tools to translate. Translating strings in javascript requires extra work.</p>
<p>We need some css that we store in <code class="file docutils literal"><span class="pre">static/starzel_votablebehavior.css</span></code></p>
<div class="highlight-css"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span class="nc">.voting</span> <span class="p">{</span>
    <span class="k">float</span><span class="o">:</span> <span class="k">right</span><span class="p">;</span>
    <span class="k">border</span><span class="o">:</span> <span class="m">1px</span> <span class="k">solid</span> <span class="m">#ddd</span><span class="p">;</span>
    <span class="k">background-color</span><span class="o">:</span> <span class="m">#DDDDDD</span><span class="p">;</span>
    <span class="k">padding</span><span class="o">:</span> <span class="m">0.5em</span> <span class="m">1em</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.voting</span> <span class="nc">.voting_option</span> <span class="p">{</span>
    <span class="k">display</span><span class="o">:</span> <span class="n">None</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.areyousure</span> <span class="p">{</span>
    <span class="k">display</span><span class="o">:</span> <span class="n">None</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.voting</span> <span class="nt">div</span><span class="nc">.votes</span> <span class="nt">span</span> <span class="p">{</span>
    <span class="k">border</span><span class="o">:</span> <span class="m">0</span> <span class="k">solid</span> <span class="m">#DDDDDD</span><span class="p">;</span>
    <span class="k">cursor</span><span class="o">:</span> <span class="k">pointer</span><span class="p">;</span>
    <span class="k">float</span><span class="o">:</span> <span class="k">left</span><span class="p">;</span>
    <span class="k">margin</span><span class="o">:</span> <span class="m">0</span> <span class="m">0.2em</span><span class="p">;</span>
    <span class="k">padding</span><span class="o">:</span> <span class="m">0</span> <span class="m">0.5em</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.votes</span> <span class="p">{</span>
    <span class="k">display</span><span class="o">:</span> <span class="k">inline</span><span class="p">;</span>
    <span class="k">float</span><span class="o">:</span> <span class="k">right</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.voting</span> <span class="nf">#voting_plus</span> <span class="p">{</span>
    <span class="k">background-color</span><span class="o">:</span> <span class="n">LimeGreen</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.voting</span> <span class="nf">#voting_neutral</span> <span class="p">{</span>
    <span class="k">background-color</span><span class="o">:</span> <span class="nb">yellow</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.voting</span> <span class="nf">#voting_negative</span> <span class="p">{</span>
    <span class="k">background-color</span><span class="o">:</span> <span class="nb">red</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="the-javascript-code">
<h2>El código javascript<a class="headerlink" href="#the-javascript-code" title="Enlazar permanentemente con este título">¶</a></h2>
<p>To make it work in the browser, some javascript <code class="file docutils literal"><span class="pre">static/starzel_votablebehavior.js</span></code></p>
<div class="highlight-js"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*global location: false, window: false, jQuery: false */</span>
<span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">,</span> <span class="nx">starzel_votablebehavior</span><span class="p">)</span> <span class="p">{</span>
    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
    <span class="nx">starzel_votablebehavior</span><span class="p">.</span><span class="nx">init_voting_viewlet</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">notyetvoted</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;#notyetvoted&quot;</span><span class="p">),</span>
            <span class="nx">alreadyvoted</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;#alreadyvoted&quot;</span><span class="p">),</span>
            <span class="nx">delete_votings</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;#delete_votings&quot;</span><span class="p">),</span>
            <span class="nx">delete_votings2</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;#delete_votings2&quot;</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;#voted&quot;</span><span class="p">).</span><span class="nx">length</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">alreadyvoted</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">notyetvoted</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="kd">function</span> <span class="nx">vote</span><span class="p">(</span><span class="nx">rating</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kd">function</span> <span class="nx">inner_vote</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">$</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;#context_url&quot;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/vote&#39;</span><span class="p">,</span> <span class="p">{</span>
                    <span class="nx">rating</span><span class="o">:</span> <span class="nx">rating</span>
                <span class="p">},</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                    <span class="nx">location</span><span class="p">.</span><span class="nx">reload</span><span class="p">();</span>
                <span class="p">});</span>
            <span class="p">};</span>
        <span class="p">}</span>

        <span class="nx">context</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;#voting_plus&quot;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="nx">vote</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
        <span class="nx">context</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;#voting_neutral&quot;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="nx">vote</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
        <span class="nx">context</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;#voting_negative&quot;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="nx">vote</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>

        <span class="nx">delete_votings</span><span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">delete_votings2</span><span class="p">.</span><span class="nx">toggle</span><span class="p">();</span>
        <span class="p">});</span>
        <span class="nx">delete_votings2</span><span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">$</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;#context_url&quot;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;href&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/clearvotes&quot;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="nx">location</span><span class="p">.</span><span class="nx">reload</span><span class="p">();</span>
            <span class="p">});</span>
        <span class="p">});</span>
    <span class="p">};</span>
<span class="p">}(</span><span class="nx">jQuery</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">starzel_votablebehavior</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">starzel_votablebehavior</span> <span class="o">||</span> <span class="p">{}));</span>
</pre></div>
</td></tr></table></div>
<p>This js-code adheres to crockfort jshint rules, so all variables are declared at the beginning of the method.
We show and hide quite a few small html elements here</p>
</div>
<div class="section" id="writing-2-simple-view-helpers">
<h2>Writing 2 simple view helpers<a class="headerlink" href="#writing-2-simple-view-helpers" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Our javascript code communicates with our site by calling views that don&#8217;t exist yet.
These Views do not need to render html, but should return a valid status.
Exceptions set the right status and aren&#8217;t being shown by javascript, so this will suit us fine.</p>
<p>As you might remember, the <code class="samp docutils literal"><span class="pre">vote</span></code> method might return an exception, if somebody votes twice.
We do not catch this exception. The user will never see this exception.</p>
<div class="admonition seealso">
<p class="first admonition-title">Ver también</p>
<p>Catching exceptions contain a gotcha for new developers.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">try</span><span class="p">:</span>
    <span class="n">something</span><span class="p">()</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">fix_something</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>Zope claims some exceptions for themselves. It needs them to work correctly.</p>
<p>For example, if two requests try to modify something at the same time, one request will throw an exception, a <code class="samp docutils literal"><span class="pre">ConflictError</span></code>.</p>
<p class="last">Zope catches the exception, waits for a random amount of time, and tries to process the request again, up to three times.
If you catch that exception, you are in trouble, so don&#8217;t do that. Ever.</p>
</div>
<p>As so often, we must extend <code class="file docutils literal"><span class="pre">browser/configure.zcml</span></code>:</p>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre>...

<span class="nt">&lt;browser:page</span>
  <span class="na">name=</span><span class="s">&quot;vote&quot;</span>
  <span class="na">for=</span><span class="s">&quot;starzel.votable_behavior.interfaces.IVotable&quot;</span>
  <span class="na">layer=</span><span class="s">&quot;..interfaces.IVotableLayer&quot;</span>
  <span class="na">class=</span><span class="s">&quot;.vote.Vote&quot;</span>
  <span class="na">permission=</span><span class="s">&quot;zope2.View&quot;</span>
  <span class="nt">/&gt;</span>

<span class="nt">&lt;browser:page</span>
  <span class="na">name=</span><span class="s">&quot;clearvotes&quot;</span>
  <span class="na">for=</span><span class="s">&quot;starzel.votable_behavior.interfaces.IVotable&quot;</span>
  <span class="na">layer=</span><span class="s">&quot;..interfaces.IVotableLayer&quot;</span>
  <span class="na">class=</span><span class="s">&quot;.vote.ClearVotes&quot;</span>
  <span class="na">permission=</span><span class="s">&quot;zope2.ViewManagementScreens&quot;</span>
  <span class="nt">/&gt;</span>

...
</pre></div>
</td></tr></table></div>
<p>Then we add our simple views into the file <code class="file docutils literal"><span class="pre">browser/vote.py</span></code></p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">zope.publisher.browser</span> <span class="kn">import</span> <span class="n">BrowserPage</span>

<span class="kn">from</span> <span class="nn">starzel.votable_behavior.interfaces</span> <span class="kn">import</span> <span class="n">IVoting</span>


<span class="k">class</span> <span class="nc">Vote</span><span class="p">(</span><span class="n">BrowserPage</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rating</span><span class="p">):</span>
        <span class="n">voting</span> <span class="o">=</span> <span class="n">IVoting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>
        <span class="n">voting</span><span class="o">.</span><span class="n">vote</span><span class="p">(</span><span class="n">rating</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;success&quot;</span>


<span class="k">class</span> <span class="nc">ClearVotes</span><span class="p">(</span><span class="n">BrowserPage</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">voting</span> <span class="o">=</span> <span class="n">IVoting</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>
        <span class="n">voting</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="s">&quot;success&quot;</span>
</pre></div>
</td></tr></table></div>
<p>A lot of moving parts have been created. Here is a small overview:</p>
<p class="graphviz">
<img src="_images/graphviz-e29c1bd6d366cf933695d2a5a442da1da61725ed.png" alt="digraph composition {
rankdir=LR;
layout=fdp;
context[label=&quot;IVotable object&quot; shape=&quot;box&quot; pos=&quot;0,0!&quot;];
viewlet[label=&quot;Voting Viewlet&quot; pos=&quot;3,-1!&quot;];
helperview1[label=&quot;Helper View for Voting&quot; pos=&quot;3,0!&quot;];
helperview2[label=&quot;Helper View for deleting all votes&quot; pos=&quot;3,1!&quot;];
js[label=&quot;JS Code&quot; shape=&quot;box&quot; pos=&quot;6,0!&quot;];
viewlet -&gt; context [headlabel=&quot;reads&quot; labeldistance=&quot;3&quot;]
helperview1 -&gt; context [label=&quot;modifies&quot;]
helperview2 -&gt; context [label=&quot;modifies&quot;]
js -&gt; helperview1 [label=&quot;calls&quot;]
js -&gt; helperview2 [taillabel=&quot;calls&quot; labelangle=&quot;-10&quot; labeldistance=&quot;6&quot;]
viewlet -&gt; js [label=&quot;loads&quot;]
js -&gt; viewlet [headlabel=&quot;manipulates&quot; labeldistance=&quot;8&quot; labelangle=&quot;-10&quot;]
}" />
</p>
</div>
</div>


          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The text and illustrations in this website are licensed by the Plone Foundation under a Creative Commons Attribution 4.0 International license.
      Actualizado por última vez en 09 de Marzo de 2015.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.2.5a',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .admonition-title").show();
        $(".toggle .admonition-title").click(function() {
            $(this).parent().children().not(".admonition-title").toggle(400);
            $(this).parent().children(".admonition-title").toggleClass("open");
        })
    });
</script>


</body>
</html>